"use strict";function _createForOfIteratorHelper(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,t=function(){};return{s:t,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){l=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(l)throw a}}}}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(r="Object"===r&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,a=!1,o=void 0;try{for(var l,i=e[Symbol.iterator]();!(n=(l=i.next()).done)&&(r.push(l.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==i.return||i.return()}finally{if(a)throw o}}return r}}function _arrayWithHoles(e){if(Array.isArray(e))return e}var MAX_SUGGESTIONS=50,MAX_SECTION_RESULTS=3,MAX_SUBSTRING_LIMIT=100,ANIMATION_TIME=200,FETCH_RESULTS_DELAY=250,CLEAR_RESULTS_DELAY=300,RTD_SEARCH_PARAMETER="rtd_search";function SafeHtmlString(e){this.value=e,this.isSafe=!0}function markAsSafe(e){return new SafeHtmlString(e)}function setElementContent(e,t){t.isSafe?e.innerHTML=t.value:e.innerText=t}var debounce=function(r,n){function e(){var e=this,t=arguments;clearTimeout(a),a=setTimeout(function(){return r.apply(e,t)},n)}var a;return e.cancel=function(){clearTimeout(a),a=null},e},buildSection=function(e,t,r,n){var a=createDomNode("span",{class:"search__result__subheading"});setElementContent(a,t);var o=createDomNode("div",{class:"outer_div_page_results",id:e});o.appendChild(a);for(var l=0;l<n.length;l+=1){var i=createDomNode("p",{class:"search__result__content"});setElementContent(i,n[l]),o.appendChild(i)}r=createDomNode("a",{href:r});return r.appendChild(o),r},updateUrl=function(){var e=new URL(window.location.href),t=getSearchTerm();0<t.length?e.searchParams.set(RTD_SEARCH_PARAMETER,t):e.searchParams.delete(RTD_SEARCH_PARAMETER),window.history.pushState({},null,e.toString())},updateSearchBar=function(){getInputField().value=getSearchTerm()},isModalVisible=function(){var e=document.querySelector(".search__outer__wrapper");return null!==e&&null!==e.style&&null!==e.style.display&&"block"===e.style.display},createDomNode=function(e,t){var r=document.createElement(e);if(null!==t)for(var n in t)r.setAttribute(n,t[n]);return r},_is_string=function(e){return"string"==typeof e&&0<e.length},get_section_html=function(e,t,r){var n=e.title,a=e.highlights;a.title.length&&(n=markAsSafe(a.title[0]));var o=[e.content.substring(0,MAX_SUBSTRING_LIMIT)+" ..."];if(a.content.length)for(var l=a.content,o=[],i=0;i<l.length&&i<MAX_SECTION_RESULTS;++i)o.push(markAsSafe("... "+l[i]+" ..."));e="".concat(t,"#").concat(e.id);return buildSection("hit__"+r,n,e,o)},generateSingleResult=function(e,t,r){var n=e.path,a=e.title,o=e.highlights;o.title.length&&(a=markAsSafe(o.title[0]));o=createDomNode("h2",{class:"search__result__title"});setElementContent(o,a);a=e.project.slug;t!==a&&((l=createDomNode("small",{class:"rtd_ui_search_subtitle"})).innerText=" (from project ".concat(a,")"),o.appendChild(l),n="".concat(e.domain).concat(n)),o.appendChild(createDomNode("br"));var l=createDomNode("a",{href:n});l.appendChild(o);var i=createDomNode("div");i.appendChild(l);for(var c=createDomNode("br",{class:"br-for-hits"}),u=0;u<e.blocks.length;++u){var s=e.blocks[u],d=null;r+=1,null!==(d="section"===s.type?get_section_html(s,n,r):d)&&(i.appendChild(d),i.appendChild(c))}return i},generateSuggestionsList=function(e,t){for(var r=createDomNode("div",{class:"search__result__box"}),n=Math.min(MAX_SUGGESTIONS,e.results.length),a=0,o=0;o<n;++o){var l=createDomNode("div",{class:"search__result__single"}),i=generateSingleResult(e.results[o],t,a);l.appendChild(i),r.appendChild(l),a+=e.results[o].blocks.length}return r},removeAllActive=function(){for(var t=document.querySelectorAll(".outer_div_page_results.active"),e=Object.keys(t).map(function(e){return t[e]}),r=1;r<=e.length;++r)e[r-1].classList.remove("active")},addActive=function(e){e=document.querySelector("#hit__"+e);null!==e&&(e.classList.add("active"),e.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"}))},selectNextResult=function(e){var t=document.querySelectorAll(".outer_div_page_results"),r=document.querySelector(".outer_div_page_results.active"),n=1,a=1;0<t.length&&(null===(t=t[t.length-1]).id||null!==(t=t.id.match(/\d+/))&&(a=Number(t[0]))),null===r||null===r.id||null!==(r=r.id.match(/\d+/))&&(n=Number(r[0]),n+=e?1:-1),n<=0?n=a:a<n&&(n=1),removeAllActive(),addActive(n)},getInputField=function(){var t;try{if(null==(t=document.querySelector("[role='search'] input")))throw"'[role='search'] input' not found"}catch(e){t=document.querySelector("input[name='q']")}return t},getSearchTerm=function(){var e=document.querySelector(".search__outer__input");return null!==e&&e.value||""},removeResults=function(){for(var e=document.querySelectorAll(".search__result__box"),t=0;t<e.length;++t)e[t].parentElement.removeChild(e[t])},getErrorDiv=function(e){var t=createDomNode("div",{class:"search__result__box search__error__box"});return t.innerText=e,t},fetchAndGenerateResults=function(t,r,n){var a=document.querySelector(".search__outer");removeResults();var e=createDomNode("div",{class:"search__result__box"});e.innerHTML="<strong>Searching ....</strong>",a.appendChild(e);return debounce(function(){updateUrl(),updateSearchBar();var e=t+"?"+new URLSearchParams(r).toString();fetch(e,{method:"GET"}).then(function(e){if(!e.ok)throw new Error;return e.json()}).then(function(e){var t;0<e.results.length?(t=generateSuggestionsList(e,n),removeResults(),a.appendChild(t),a.addEventListener("mouseenter",function(e){removeAllActive()})):(removeResults(),t=getErrorDiv("No results found"),a.appendChild(t))}).catch(function(e){removeResults();var t=getErrorDiv("There was an error. Please try again.");a.appendChild(t)})},FETCH_RESULTS_DELAY)},generateAndReturnInitialHtml=function(e){var t=createDomNode("div",{class:"search__outer__wrapper search__backdrop"});t.innerHTML='\n        <div class="search__outer">\n          <div class="search__cross" title="Close">\n            \x3c!--?xml version="1.0" encoding="UTF-8"?--\x3e\n            <svg class="search__cross__img" width="15px" height="15px" enable-background="new 0 0 612 612" version="1.1" viewBox="0 0 612 612" xml:space="preserve" xmlns="http://www.w3.org/2000/svg">\n              <polygon points="612 36.004 576.52 0.603 306 270.61 35.478 0.603 0 36.004 270.52 306.01 0 576 35.478 611.4 306 341.41 576.52 611.4 612 576 341.46 306.01"></polygon>\n            </svg>\n          </div>\n          <input class="search__outer__input" placeholder="Search...">\n          <div class="bar"></div>\n          <div class="search__filters">\n            <ul>\n            </ul>\n          </div>\n        </div>\n        <div class="rtd__search__credits">\n          Search by <a href="https://readthedocs.org/">Read the Docs</a> & <a href="https://readthedocs-sphinx-search.readthedocs.io/en/latest/">readthedocs-sphinx-search</a>\n        </div>\n    ';var r,n=t.querySelector(".search__filters ul"),a=getConfig();0<e.length&&((r=createDomNode("li",{class:"search__filters__title"})).innerText="Filters:",n.appendChild(r));for(var o=0,l=e.length;o<l;o++){var i=_slicedToArray(e[o],2),c=i[0],u=i[1],s=createDomNode("li",{class:"search__filter",title:u}),i="rtd-search-filter-".concat(o),u=createDomNode("input",{type:"checkbox",id:i}),i=createDomNode("label",{for:i});i.innerText=c,u.value=o,s.appendChild(u),s.appendChild(i),n.appendChild(s),u.addEventListener("click",function(e){var t=_createForOfIteratorHelper(document.querySelectorAll(".search__filters input"));try{for(t.s();!(r=t.n()).done;){var r=r.value;r.checked&&r.value!=e.target.value&&(r.checked=!1)}}catch(e){t.e(e)}finally{t.f()}var n=getSearchTerm(),n={q:n=getCurrentFilter(a)+" "+n};fetchAndGenerateResults(a.api_endpoint,n,a.project)()})}return t},showSearchModal=function(r){removeResults();function e(){var e=getInputField();e.blur();var t=document.querySelector(".search__outer__input");null!==t&&(void 0!==r&&_is_string(r)?(t.value=r,e.value=r):t.value=e.value,t.focus())}var t;window.jQuery?$(".search__outer__wrapper").fadeIn(ANIMATION_TIME,e):((t=document.querySelector(".search__outer__wrapper"))&&t.style&&(t.style.display="block"),e())},removeSearchModal=function(){removeResults(),updateSearchBar();var e=document.querySelector(".search__outer__input");null!==e&&(e.value="",e.blur()),updateUrl(),window.jQuery?$(".search__outer__wrapper").fadeOut(ANIMATION_TIME):(e=document.querySelector(".search__outer__wrapper"))&&e.style&&(e.style.display="none")};function getConfig(){var e=READTHEDOCS_DATA.project,t=READTHEDOCS_DATA.version,r=READTHEDOCS_DATA.proxied_api_host||"/_",n=RTD_SEARCH_CONFIG||{};return{project:e,version:t,api_endpoint:r+"/api/v3/search/",filters:n.filters,default_filter:n.default_filter}}function getCurrentFilter(e){var t=document.querySelector(".search__filters input:checked");return null==t?e.default_filter:e.filters[parseInt(t.value)][1]}window.addEventListener("DOMContentLoaded",function(){var r,e,t,n,a,o;window.hasOwnProperty("READTHEDOCS_DATA")?(r=getConfig(),o=generateAndReturnInitialHtml(r.filters),document.body.appendChild(o),e=document.querySelector(".search__outer__wrapper"),t=document.querySelector(".search__outer__input"),o=document.querySelector(".search__cross"),n=null,(a=getInputField()).addEventListener("focus",function(e){showSearchModal()}),t.addEventListener("input",function(e){var t=getSearchTerm();0<t.length?(null!==n&&n.cancel(),t={q:t=getCurrentFilter(r)+" "+t},(n=fetchAndGenerateResults(r.api_endpoint,t,r.project))()):(debounce(function(){removeResults(),updateUrl()},CLEAR_RESULTS_DELAY)(),updateUrl())}),t.addEventListener("keydown",function(e){var t;40===e.keyCode&&(e.preventDefault(),selectNextResult(!0)),38===e.keyCode&&(e.preventDefault(),selectNextResult(!1)),13===e.keyCode&&(e.preventDefault(),null!==(e=document.querySelector(".outer_div_page_results.active"))?(t=e.parentElement.href,window.location.href=t):(t=getInputField().parentElement,a.value=getSearchTerm(),t.submit()))}),e.addEventListener("click",function(e){e.target.parentNode===document.body&&removeSearchModal()}),o.addEventListener("click",function(e){removeSearchModal()}),document.addEventListener("keydown",function(e){27===e.keyCode&&removeSearchModal()}),document.addEventListener("keydown",function(e){191!==e.keyCode||isModalVisible()||(e.preventDefault(),showSearchModal())}),null!==(o=new URLSearchParams(document.location.search).get(RTD_SEARCH_PARAMETER))&&(showSearchModal(o),t.value=o,(o=document.createEvent("Event")).initEvent("input",!0,!0),t.dispatchEvent(o))):console.log("[INFO] Docs are not being served on Read the Docs, readthedocs-sphinx-search will not work.")});